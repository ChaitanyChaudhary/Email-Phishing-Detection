EMAIL PHISHING DETECTION - SEQUENCE DIAGRAM (Simple Text Format)
==================================================================

PARTICIPANTS:
-------------
User
Main
Login
Gmail
ModelTrainer
PhishingDetector
MLModel
Vectorizer
Logging
Config


SEQUENCE OF INTERACTIONS:
=========================

1. User -> Main: Start Application

2. Main -> Config: Load Environment Variables
   Config -> Main: Return Configuration Data

3. Main -> Logging: Initialize Logging System
   Logging -> Main: Logging System Ready

4. Main -> Login: Authenticate with Gmail

5. Login -> Gmail: Connect to IMAP Server
   Gmail -> Login: Connection Established

6. Login -> Gmail: Login with Credentials
   Gmail -> Login: Authentication Result

   IF Authentication Successful:
      7. Login -> Main: Return Mail Connection

      8. Main -> ModelTrainer: Check for Existing Model
         ModelTrainer -> Main: Model Check Result

         IF Model Exists:
            9. Main -> ModelTrainer: Load Model and Vectorizer

            10. ModelTrainer -> MLModel: Load from File
                MLModel -> ModelTrainer: Model Loaded

            11. ModelTrainer -> Vectorizer: Load from File
                Vectorizer -> ModelTrainer: Vectorizer Loaded

            12. ModelTrainer -> Main: Model and Vectorizer Ready

         ELSE No Model Found:
            13. Main -> ModelTrainer: Train New Model

            14. ModelTrainer -> ModelTrainer: Load Training Dataset
                ModelTrainer -> ModelTrainer: Read emails.csv File

            15. ModelTrainer -> ModelTrainer: Preprocess Text Data
                ModelTrainer -> ModelTrainer: Clean and Normalize Text

            16. ModelTrainer -> Vectorizer: Fit Term Frequency-Inverse Document Frequency Vectorizer
                Vectorizer -> ModelTrainer: Vectorizer Trained

            17. ModelTrainer -> MLModel: Train Naive Bayes Model
                MLModel -> ModelTrainer: Model Trained

            18. ModelTrainer -> ModelTrainer: Save Model and Vectorizer
                ModelTrainer -> ModelTrainer: Save to Files

            19. ModelTrainer -> Main: Training Complete

      START EMAIL MONITORING LOOP (Repeats Continuously):

      20. Main -> Gmail: Fetch Unread Emails
          Gmail -> Main: Return Email List

          FOR EACH EMAIL IN LIST:

          21. Main -> PhishingDetector: Process Email

          22. PhishingDetector -> PhishingDetector: Parse Email Components
              PhishingDetector -> PhishingDetector: Extract Raw Email Data

          23. PhishingDetector -> PhishingDetector: Extract Subject and Body
              PhishingDetector -> PhishingDetector: Parse Email Headers

          24. PhishingDetector -> PhishingDetector: Preprocess Text
              PhishingDetector -> PhishingDetector: Clean Email Content

          25. PhishingDetector -> Vectorizer: Transform to Features
              Vectorizer -> PhishingDetector: Feature Vector

          26. PhishingDetector -> MLModel: Predict Classification
              MLModel -> PhishingDetector: Prediction Result

          27. PhishingDetector -> Logging: Log Analysis Result
              Logging -> PhishingDetector: Log Entry Created

          28. PhishingDetector -> Main: Return Classification Result

          29. Main -> User: Display Result
              Main -> User: Print Classification Message

          END FOR EACH EMAIL

      30. Main -> Main: Wait 60 Seconds
          Main -> Main: Sleep for 60 Seconds

      31. Main -> Main: Continue to Step 20 (Return to Email Monitoring Loop)

      END EMAIL MONITORING LOOP

   ELSE Authentication Failed:
      7. Login -> Main: Authentication Failed

      8. Main -> Logging: Log Error
         Logging -> Main: Error Logged

      9. Main -> User: Display Error and Exit
         Main -> User: Show Error Message

      APPLICATION TERMINATES


SEQUENCE SUMMARY:
=================

PHASE 1: INITIALIZATION
- User starts application
- Main loads configuration
- Logging system initialized
- Gmail authentication attempted

PHASE 2: MODEL MANAGEMENT
- Model existence checked
- If model exists: Load from files
- If no model: Train new model using dataset
- Model and vectorizer prepared for use

PHASE 3: EMAIL PROCESSING LOOP (Continuous)
- Fetch unread emails from Gmail
- For each email:
  * Parse email components
  * Extract subject and body
  * Preprocess text content
  * Transform to feature vector
  * Predict using ML model
  * Log results
  * Display to user
- Wait 60 seconds
- Repeat loop

PHASE 4: ERROR HANDLING
- Authentication failures logged and application exits
- Processing errors logged and system continues
- Model loading errors raise exceptions


INTERACTION PATTERNS:
=====================

SYNCHRONOUS CALLS:
- Main -> Config: Request configuration
- Main -> Login: Request authentication
- Main -> ModelTrainer: Request model operations
- PhishingDetector -> Vectorizer: Request feature transformation
- PhishingDetector -> MLModel: Request prediction

ASYNCHRONOUS PATTERNS:
- Email monitoring loop runs continuously
- Background logging operations
- Repeated email fetching at intervals

RETURN PATHS:
- All method calls return responses to caller
- Error conditions return None or raise exceptions
- Loop continues indefinitely until application termination


DATA FLOW:
==========

INPUT:
- Configuration from Config
- Email data from Gmail IMAP
- Training data from CSV files

PROCESSING:
- Text preprocessing in PhishingDetector
- Feature extraction in Vectorizer
- Classification in MLModel

OUTPUT:
- Results displayed to User
- Logs written by Logging
- Models saved to files by ModelTrainer
